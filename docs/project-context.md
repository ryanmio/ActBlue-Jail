ActBlue Jail is a minimal Next.js + Supabase app that ingests screenshots of political SMS/emails, extracts text, classifies potential ActBlue policy violations, and renders a public case. The web app lives in `web/` (App Router, TypeScript, Tailwind). Upload flow is on `web/src/app/page.tsx`: the client creates a submission via `POST /api/upload`, uploads the file to Supabase Storage, and concurrently posts a data URL to `POST /api/ocr`. OCR is non‑AI Tesseract via OCR.space (fast and reliable) implemented in `web/src/app/api/ocr/route.ts`, which preprocesses the image with Sharp, calls OCR.space, saves `raw_text` and OCR metrics to Postgres, and kicks the classifier.

The public board and detail pages are in `web/src/app/cases/page.tsx` and `web/src/app/cases/[id]/page.tsx`. Case data is served by `GET /api/cases` and `GET /api/cases/[id]` (see `web/src/app/api/cases/route.ts` and `web/src/app/api/cases/[id]/route.ts`). Screenshots are displayed via a signed URL from `GET /api/cases/[id]/image-url`. Supabase integration is handled in `web/src/lib/supabase-server.ts` (server) and `web/src/lib/supabase.ts` (browser). The database schema (submissions, violations, audit) and indexes are in `web/src/server/db/schema.ts` with SQL in `web/sql/schema.sql`. Environment parsing is centralized in `web/src/lib/env.ts`; set `NEXT_PUBLIC_SUPABASE_URL`, `NEXT_PUBLIC_SUPABASE_ANON_KEY`, `SUPABASE_SERVICE_ROLE_KEY`, `OCRSPACE_API_KEY`, and `OPENAI_API_KEY` (for classification only) in `.env.local` (example: `web/env.example`).

The policy classifier runs in `web/src/app/api/classify/route.ts`. It reads `raw_text` (and an optional signed screenshot), submits a strict JSON request to OpenAI with a compact taxonomy (AB001–AB008), clear rules (e.g., avoid false AB003 when a full entity name is present; deduplicate codes), and a few‑shot example. The route parses JSON robustly, merges duplicate codes, saves violations to the `violations` table, and updates the submission with `processing_status`, `ai_version`, and `ai_confidence`. A stub email draft helper exists at `web/src/server/email/draft.ts` for future outbound reporting.

End‑to‑end flow today:
- Client: drop file → `POST /api/upload` → Storage upload + `POST /api/ocr` → redirect to `/cases/{id}`
- Server: OCR.space returns text → save to `submissions` → `POST /api/classify` → save violations → case page renders text/violations